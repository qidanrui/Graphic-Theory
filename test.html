<!DOCTYPE html>
<meta charset="utf-8">
<style>

.link {
  fill: none;
  stroke: #666;
  stroke-width: 1.5px;
}

#licensing {
  fill: green;
}

.link.licensing {
  stroke: green;
}

.link.resolved {
  stroke-dasharray: 0,2 1;
}

circle {
  fill: #ccc;
  stroke: #333;
  stroke-width: 1.5px;
}

text {
  font: 12px Microsoft YaHei;
  pointer-events: none;
  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;
}

.linetext {
    font-size: 12px Microsoft YaHei;
}

html,
body {
  background-color: #333;
}

</style>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<script>
  $(function() {
    $("#slider").slider({
      orientation: "horizontal",
      range: "min",
      max: 100,
      min: 10,
      value: 30,
      slide: changeScale,
      change: changeScale
    });
  });
</script>
<body>
<div id='slider'></div>
<div id='node_info' style="width:100; height:100;"></div>
<div id='selector'>
  <select id='calculator'>
  <option value="MinimumSpanningTree">Minimum Spanning Tree</option>
  <option value="PointCloseness">Point Closeness</option>
  <option value="PointBetweeness">Point Betweeness</option>
  <option value="ConnectedComponent">Connected Component</option>
  </select>
  <button onclick="draw()">Draw</button>
</div>
<div id='gotoSelector'>
  From
  <select id='fromOptions'>    
  </select>
  To
  <select id='toOptions'>
  </select>
  <button onclick="drawShortestPath()">Goto</button>
</div>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="static/js/npm.js"></script>
<script>

// http://blog.thomsonreuters.com/index.php/mobile-patent-suits-graphic-of-the-day/
var node_info =[
{"id" : 0, "group" : 1},
{"id" : 1, "group" : 1},
{"id" : 2, "group" : 1},
{"id" : 3, "group" : 1},
{"id" : 4, "group" : 1},
{"id" : 5, "group" : 1},
{"id" : 6, "group" : 1},
{"id" : 7, "group" : 1},
{"id" : 8, "group" : 1},
{"id" : 9, "group" : 1},
{"id" : 10, "group" : 1},
{"id" : 11, "group" : 1},
{"id" : 12, "group" : 1},
{"id" : 13, "group" : 1},
{"id" : 14, "group" : 1},
{"id" : 15, "group" : 1},
{"id" : 16, "group" : 1},
{"id" : 17, "group" : 1},
{"id" : 18, "group" : 1},
{"id" : 19, "group" : 1},
{"id" : 20, "group" : 1},
{"id" : 21, "group" : 1},
{"id" : 22, "group" : 1},
{"id" : 23, "group" : 1},
{"id" : 24, "group" : 1},
{"id" : 25, "group" : 1},
{"id" : 26, "group" : 1},
{"id" : 27, "group" : 1},
{"id" : 28, "group" : 1},
{"id" : 29, "group" : 1},
{"id" : 30, "group" : 1},
{"id" : 31, "group" : 1},
{"id" : 32, "group" : 1},
{"id" : 33, "group" : 1},
{"id" : 34, "group" : 1},
{"id" : 35, "group" : 1},
{"id" : 36, "group" : 1},
{"id" : 37, "group" : 1},
{"id" : 38, "group" : 1},
{"id" : 39, "group" : 1},
{"id" : 40, "group" : 1},
{"id" : 41, "group" : 1},
{"id" : 42, "group" : 1},
{"id" : 43, "group" : 1},
{"id" : 44, "group" : 1},
{"id" : 45, "group" : 1},
{"id" : 46, "group" : 1},
{"id" : 47, "group" : 1},
{"id" : 48, "group" : 1},
{"id" : 49, "group" : 1},
{"id" : 50, "group" : 1},
{"id" : 51, "group" : 1},
{"id" : 52, "group" : 1},
{"id" : 53, "group" : 1},
{"id" : 54, "group" : 1},
{"id" : 55, "group" : 1},
{"id" : 56, "group" : 1},
{"id" : 57, "group" : 1},
{"id" : 58, "group" : 1},
{"id" : 59, "group" : 1},
{"id" : 60, "group" : 1},
{"id" : 61, "group" : 1},
{"id" : 62, "group" : 1},
{"id" : 63, "group" : 1},
{"id" : 64, "group" : 1},
{"id" : 65, "group" : 1},
{"id" : 66, "group" : 1},
{"id" : 67, "group" : 1},
{"id" : 68, "group" : 1},
{"id" : 69, "group" : 1},
{"id" : 70, "group" : 1},
{"id" : 71, "group" : 1},
{"id" : 72, "group" : 1},
{"id" : 73, "group" : 1},
{"id" : 74, "group" : 1},
{"id" : 75, "group" : 1},
{"id" : 76, "group" : 1},
{"id" : 77, "group" : 1},
{"id" : 78, "group" : 1},
{"id" : 79, "group" : 1},
{"id" : 80, "group" : 1},
{"id" : 81, "group" : 1},
{"id" : 82, "group" : 1},
{"id" : 83, "group" : 1},
{"id" : 84, "group" : 1},
{"id" : 85, "group" : 1},
{"id" : 86, "group" : 1},
{"id" : 87, "group" : 1},
{"id" : 88, "group" : 1},
{"id" : 89, "group" : 1},
{"id" : 90, "group" : 1},
{"id" : 91, "group" : 1},
{"id" : 92, "group" : 1},
{"id" : 93, "group" : 1},
{"id" : 94, "group" : 1},
{"id" : 95, "group" : 1},
{"id" : 96, "group" : 1},
{"id" : 97, "group" : 1},
{"id" : 98, "group" : 1},
{"id" : 99, "group" : 1},
];
var links = [{"source": 0, "target": 51, "value": 1.7603541678802355}, {"source": 1, "target": 3, "value": 1.1077049444827338}, {"source": 1, "target": 6, "value": 0.99219678190590677}, {"source": 1, "target": 9, "value": 0.11763497953855823}, {"source": 1, "target": 13, "value": 2.8916643442803296}, {"source": 1, "target": 20, "value": 1.7368983126541231}, {"source": 1, "target": 22, "value": 1.6650776654883614}, {"source": 1, "target": 29, "value": 1.4823013145375818}, {"source": 1, "target": 36, "value": 1.3002185487774389}, {"source": 1, "target": 76, "value": 0.15797116329553285}, {"source": 1, "target": 88, "value": 0.96286137553720941}, {"source": 1, "target": 90, "value": 0.33765052730391432}, {"source": 1, "target": 96, "value": 0.0021268169617310838}, {"source": 1, "target": 99, "value": 0.15063731170334801}, {"source": 2, "target": 67, "value": 1.789751655307664}, {"source": 3, "target": 1, "value": 1.1077049444827338}, {"source": 3, "target": 5, "value": 3.5462105988823223}, {"source": 3, "target": 23, "value": 2.9026651216685861}, {"source": 3, "target": 25, "value": 3.5627117649647171}, {"source": 3, "target": 28, "value": 1.7439165701042851}, {"source": 3, "target": 37, "value": 1.7897531425553987}, {"source": 3, "target": 39, "value": 0.018627983044125974}, {"source": 3, "target": 51, "value": 3.2308549804186053}, {"source": 3, "target": 53, "value": 0.031462223330449422}, {"source": 3, "target": 58, "value": 1.0306995027648562}, {"source": 3, "target": 63, "value": 3.7148891855024475}, {"source": 3, "target": 67, "value": 3.9569062880443582}, {"source": 3, "target": 92, "value": 1.6834122944688024}, {"source": 3, "target": 94, "value": 2.2187834606978756}, {"source": 4, "target": 25, "value": 1.7890526397545679}, {"source": 5, "target": 3, "value": 3.5462105988823223}, {"source": 5, "target": 6, "value": 4.0980829311938107}, {"source": 5, "target": 9, "value": 3.9349047332678246}, {"source": 5, "target": 10, "value": 0.3064816580371707}, {"source": 5, "target": 13, "value": 5.3925077372134265}, {"source": 5, "target": 15, "value": 1.8396730160579406}, {"source": 5, "target": 16, "value": 1.5828430515912313}, {"source": 5, "target": 21, "value": 1.2397142731419559}, {"source": 5, "target": 22, "value": 3.799228478812489}, {"source": 5, "target": 26, "value": 1.9620986549716162}, {"source": 5, "target": 30, "value": 1.1425407395455909}, {"source": 5, "target": 36, "value": 2.7413203866406461}, {"source": 5, "target": 41, "value": 1.7496747635968233}, {"source": 5, "target": 43, "value": 1.1260395734631752}, {"source": 5, "target": 44, "value": 0.77218123414052975}, {"source": 5, "target": 61, "value": 1.9107616938263643}, {"source": 5, "target": 72, "value": 0.28264664036257003}, {"source": 5, "target": 74, "value": 0.96102791263914233}, {"source": 5, "target": 76, "value": 0.97936254161960434}, {"source": 5, "target": 79, "value": 1.5477360400134879}, {"source": 5, "target": 80, "value": 0.058964166801121549}, {"source": 5, "target": 81, "value": 1.30938586326767}, {"source": 5, "target": 82, "value": 1.6760784428766176}, {"source": 5, "target": 88, "value": 2.9906713407747416}, {"source": 5, "target": 90, "value": 1.9547648033794314}, {"source": 5, "target": 96, "value": 2.3159569942942615}, {"source": 5, "target": 99, "value": 1.687079220264895}, {"source": 6, "target": 1, "value": 0.99219678190590677}, {"source": 6, "target": 5, "value": 4.0980829311938107}, {"source": 6, "target": 13, "value": 1.1590419056279857}, {"source": 6, "target": 23, "value": 2.5891429661029361}, {"source": 6, "target": 25, "value": 3.487539786144886}, {"source": 6, "target": 28, "value": 2.1124426126112796}, {"source": 6, "target": 37, "value": 1.179209997506494}, {"source": 6, "target": 51, "value": 3.452703991082029}, {"source": 6, "target": 58, "value": 0.44582483828855662}, {"source": 6, "target": 63, "value": 4.0650805990290007}, {"source": 6, "target": 67, "value": 3.6103818003138768}, {"source": 6, "target": 92, "value": 1.329553955146157}, {"source": 6, "target": 94, "value": 2.3269577716825389}, {"source": 7, "target": 63, "value": 0.044296463616751894}, {"source": 8, "target": 63, "value": 1.7589173025766489}, {"source": 9, "target": 1, "value": 0.11763497953855823}, {"source": 9, "target": 5, "value": 3.9349047332678246}, {"source": 9, "target": 23, "value": 3.1923522595596769}, {"source": 9, "target": 25, "value": 3.2070199627440261}, {"source": 9, "target": 28, "value": 1.274550068204813}, {"source": 9, "target": 37, "value": 0.91702480308607515}, {"source": 9, "target": 51, "value": 3.637883743784549}, {"source": 9, "target": 58, "value": 0.85835399034863857}, {"source": 9, "target": 63, "value": 3.8982354753069215}, {"source": 9, "target": 67, "value": 3.4692051571644447}, {"source": 9, "target": 92, "value": 1.3607228244129215}, {"source": 9, "target": 94, "value": 2.5231383017733151}, {"source": 10, "target": 5, "value": 0.3064816580371707}, {"source": 10, "target": 51, "value": 0.1744723293779277}, {"source": 10, "target": 63, "value": 0.65850653446176977}, {"source": 11, "target": 63, "value": 1.6612687132288693}, {"source": 12, "target": 25, "value": 1.8103726141239975}, {"source": 13, "target": 1, "value": 2.8916643442803296}, {"source": 13, "target": 5, "value": 5.3925077372134265}, {"source": 13, "target": 6, "value": 1.1590419056279857}, {"source": 13, "target": 23, "value": 4.1145840972762056}, {"source": 13, "target": 25, "value": 5.034982472094689}, {"source": 13, "target": 28, "value": 2.4131305278906265}, {"source": 13, "target": 37, "value": 1.6192410930372272}, {"source": 13, "target": 39, "value": 1.179209997506494}, {"source": 13, "target": 51, "value": 4.8498027193921693}, {"source": 13, "target": 56, "value": 0.92069172888216766}, {"source": 13, "target": 58, "value": 1.7585842732886339}, {"source": 13, "target": 63, "value": 5.5391847690570186}, {"source": 13, "target": 67, "value": 5.2348299279815791}, {"source": 13, "target": 92, "value": 2.4039632134004165}, {"source": 13, "target": 94, "value": 3.5847133197412506}, {"source": 14, "target": 37, "value": 1.6580648919438459}, {"source": 15, "target": 5, "value": 1.8396730160579406}, {"source": 16, "target": 5, "value": 1.5828430515912313}, {"source": 17, "target": 25, "value": 1.6506087260441542}, {"source": 18, "target": 22, "value": 1.5044950583483816}, {"source": 19, "target": 63, "value": 1.7069959806605697}, {"source": 20, "target": 1, "value": 1.7368983126541231}, {"source": 21, "target": 5, "value": 1.2397142731419559}, {"source": 21, "target": 23, "value": 0.95186059814893209}, {"source": 21, "target": 25, "value": 1.556903354503719}, {"source": 21, "target": 28, "value": 0.0057937427578025292}, {"source": 21, "target": 51, "value": 1.4707305982956105}, {"source": 21, "target": 63, "value": 2.4204643794828113}, {"source": 21, "target": 67, "value": 1.9914340613403345}, {"source": 22, "target": 1, "value": 1.6650776654883614}, {"source": 22, "target": 5, "value": 3.799228478812489}, {"source": 22, "target": 18, "value": 1.5044950583483816}, {"source": 22, "target": 23, "value": 3.2766915528697398}, {"source": 22, "target": 25, "value": 3.2510230722971141}, {"source": 22, "target": 28, "value": 1.8355897150065328}, {"source": 22, "target": 36, "value": 0.35415169338633012}, {"source": 22, "target": 37, "value": 1.9474309517872466}, {"source": 22, "target": 51, "value": 3.7405576660750732}, {"source": 22, "target": 58, "value": 1.188377311996704}, {"source": 22, "target": 63, "value": 3.769893072443792}, {"source": 22, "target": 67, "value": 4.1769218358097353}, {"source": 22, "target": 92, "value": 2.0904410578347457}, {"source": 22, "target": 94, "value": 3.3078604221364833}, {"source": 22, "target": 95, "value": 0.16530501488771765}, {"source": 23, "target": 3, "value": 2.9026651216685861}, {"source": 23, "target": 6, "value": 2.5891429661029361}, {"source": 23, "target": 9, "value": 3.1923522595596769}, {"source": 23, "target": 13, "value": 4.1145840972762056}, {"source": 23, "target": 21, "value": 0.95186059814893209}, {"source": 23, "target": 22, "value": 3.2766915528697398}, {"source": 23, "target": 26, "value": 1.4065593968640351}, {"source": 23, "target": 30, "value": 0.44032444959443895}, {"source": 23, "target": 36, "value": 2.152778796368275}, {"source": 23, "target": 43, "value": 0.25514469689189789}, {"source": 23, "target": 61, "value": 1.0802030010120618}, {"source": 23, "target": 74, "value": 0.83818589847015124}, {"source": 23, "target": 76, "value": 0.50449565102599325}, {"source": 23, "target": 79, "value": 0.84185282426624364}, {"source": 23, "target": 80, "value": 0.060797629699146788}, {"source": 23, "target": 81, "value": 0.79784971471317667}, {"source": 23, "target": 82, "value": 1.3038854745735313}, {"source": 23, "target": 88, "value": 2.5194713759772225}, {"source": 23, "target": 90, "value": 1.600906464056786}, {"source": 23, "target": 96, "value": 1.9107616938263643}, {"source": 23, "target": 99, "value": 1.3735570646992243}, {"source": 24, "target": 76, "value": 1.7155977553833908}, {"source": 25, "target": 3, "value": 3.5627117649647171}, {"source": 25, "target": 4, "value": 1.7890526397545679}, {"source": 25, "target": 6, "value": 3.487539786144886}, {"source": 25, "target": 9, "value": 3.2070199627440261}, {"source": 25, "target": 12, "value": 1.8103726141239975}, {"source": 25, "target": 13, "value": 5.034982472094689}, {"source": 25, "target": 17, "value": 1.6506087260441542}, {"source": 25, "target": 21, "value": 1.556903354503719}, {"source": 25, "target": 22, "value": 3.2510230722971141}, {"source": 25, "target": 26, "value": 1.8429235665986965}, {"source": 25, "target": 30, "value": 1.6540768881000842}, {"source": 25, "target": 32, "value": 1.7727034426515993}, {"source": 25, "target": 34, "value": 1.8255762024038369}, {"source": 25, "target": 35, "value": 1.7509757092095299}, {"source": 25, "target": 36, "value": 2.5121375243850586}, {"source": 25, "target": 43, "value": 1.4468955806210304}, {"source": 25, "target": 44, "value": 0.82535165818384881}, {"source": 25, "target": 45, "value": 1.8343527310149317}, {"source": 25, "target": 47, "value": 1.8100231063474497}, {"source": 25, "target": 55, "value": 1.7480243102075688}, {"source": 25, "target": 59, "value": 1.8223529640201162}, {"source": 25, "target": 61, "value": 2.0519383369758173}, {"source": 25, "target": 72, "value": 0.5448318347829888}, {"source": 25, "target": 74, "value": 1.0361998914589949}, {"source": 25, "target": 75, "value": 0.19097349546034359}, {"source": 25, "target": 76, "value": 1.626574944629412}, {"source": 25, "target": 79, "value": 1.0508675946433435}, {"source": 25, "target": 80, "value": 0.20014080995055364}, {"source": 25, "target": 81, "value": 1.0251991140707175}, {"source": 25, "target": 82, "value": 1.6632442025903151}, {"source": 25, "target": 87, "value": 1.6789382730432418}, {"source": 25, "target": 88, "value": 2.9558355457118841}, {"source": 25, "target": 90, "value": 2.4186309165847653}, {"source": 25, "target": 96, "value": 1.8337562521084654}, {"source": 25, "target": 97, "value": 1.8270713190035144}, {"source": 25, "target": 99, "value": 2.4222978423808574}, {"source": 26, "target": 5, "value": 1.9620986549716162}, {"source": 26, "target": 23, "value": 1.4065593968640351}, {"source": 26, "target": 25, "value": 1.8429235665986965}, {"source": 26, "target": 28, "value": 0.25514469689189789}, {"source": 26, "target": 51, "value": 1.7970869941475833}, {"source": 26, "target": 63, "value": 2.4864690438124328}, {"source": 26, "target": 67, "value": 2.3727943441336521}, {"source": 26, "target": 94, "value": 0.27164586297431376}, {"source": 27, "target": 28, "value": 1.6604531950835906}, {"source": 28, "target": 3, "value": 1.7439165701042851}, {"source": 28, "target": 6, "value": 2.1124426126112796}, {"source": 28, "target": 9, "value": 1.274550068204813}, {"source": 28, "target": 13, "value": 2.4131305278906265}, {"source": 28, "target": 21, "value": 0.0057937427578025292}, {"source": 28, "target": 22, "value": 1.8355897150065328}, {"source": 28, "target": 26, "value": 0.25514469689189789}, {"source": 28, "target": 27, "value": 1.6604531950835906}, {"source": 28, "target": 36, "value": 0.55033222347712751}, {"source": 28, "target": 82, "value": 0.11946844243658347}, {"source": 28, "target": 88, "value": 2.0354371708934016}, {"source": 28, "target": 90, "value": 0.73184505038355507}, {"source": 28, "target": 96, "value": 0.45865907857488009}, {"source": 28, "target": 99, "value": 0.72451119879137038}, {"source": 29, "target": 1, "value": 1.4823013145375818}, {"source": 30, "target": 5, "value": 1.1425407395455909}, {"source": 30, "target": 23, "value": 0.44032444959443895}, {"source": 30, "target": 25, "value": 1.6540768881000842}, {"source": 30, "target": 51, "value": 0.60716957331649701}, {"source": 30, "target": 63, "value": 1.2305469586517459}, {"source": 30, "target": 67, "value": 1.538568725523257}, {"source": 31, "target": 67, "value": 1.8281004252344615}, {"source": 32, "target": 25, "value": 1.7727034426515993}, {"source": 33, "target": 67, "value": 1.7840624453894098}, {"source": 34, "target": 25, "value": 1.8255762024038369}, {"source": 35, "target": 25, "value": 1.7509757092095299}, {"source": 36, "target": 1, "value": 1.3002185487774389}, {"source": 36, "target": 5, "value": 2.7413203866406461}, {"source": 36, "target": 22, "value": 0.35415169338633012}, {"source": 36, "target": 23, "value": 2.152778796368275}, {"source": 36, "target": 25, "value": 2.5121375243850586}, {"source": 36, "target": 28, "value": 0.55033222347712751}, {"source": 36, "target": 37, "value": 0.25147777109582647}, {"source": 36, "target": 51, "value": 3.2546899980932062}, {"source": 36, "target": 58, "value": 0.46049254147292629}, {"source": 36, "target": 63, "value": 2.9686697859982076}, {"source": 36, "target": 67, "value": 2.5909764290009827}, {"source": 36, "target": 90, "value": 0.20747466154273847}, {"source": 36, "target": 92, "value": 0.90052363700368043}, {"source": 36, "target": 94, "value": 1.7695850506769113}, {"source": 37, "target": 3, "value": 1.7897531425553987}, {"source": 37, "target": 6, "value": 1.179209997506494}, {"source": 37, "target": 9, "value": 0.91702480308607515}, {"source": 37, "target": 13, "value": 1.6192410930372272}, {"source": 37, "target": 14, "value": 1.6580648919438459}, {"source": 37, "target": 22, "value": 1.9474309517872466}, {"source": 37, "target": 36, "value": 0.25147777109582647}, {"source": 37, "target": 42, "value": 1.7142968097706839}, {"source": 37, "target": 88, "value": 0.46782639306511109}, {"source": 37, "target": 90, "value": 0.080965721577655053}, {"source": 37, "target": 96, "value": 0.15247077460139422}, {"source": 38, "target": 63, "value": 1.7638686627444127}, {"source": 39, "target": 3, "value": 0.018627983044125974}, {"source": 39, "target": 13, "value": 1.179209997506494}, {"source": 40, "target": 56, "value": 1.2035106114444378}, {"source": 41, "target": 5, "value": 1.7496747635968233}, {"source": 42, "target": 37, "value": 1.7142968097706839}, {"source": 43, "target": 5, "value": 1.1260395734631752}, {"source": 43, "target": 23, "value": 0.25514469689189789}, {"source": 43, "target": 25, "value": 1.4468955806210304}, {"source": 43, "target": 51, "value": 0.74467929066985761}, {"source": 43, "target": 63, "value": 1.496399078868236}, {"source": 43, "target": 67, "value": 1.3680566760051067}, {"source": 44, "target": 5, "value": 0.77218123414052975}, {"source": 44, "target": 25, "value": 0.82535165818384881}, {"source": 44, "target": 51, "value": 0.43849098669639275}, {"source": 44, "target": 63, "value": 0.90052363700368043}, {"source": 44, "target": 67, "value": 1.2708831424087206}, {"source": 45, "target": 25, "value": 1.8343527310149317}, {"source": 46, "target": 68, "value": 1.4627677132482866}, {"source": 47, "target": 25, "value": 1.8100231063474497}, {"source": 48, "target": 68, "value": 1.5594066134638163}, {"source": 49, "target": 56, "value": 1.645735034271179}, {"source": 50, "target": 76, "value": 1.6663171588901187}, {"source": 51, "target": 0, "value": 1.7603541678802355}, {"source": 51, "target": 3, "value": 3.2308549804186053}, {"source": 51, "target": 6, "value": 3.452703991082029}, {"source": 51, "target": 9, "value": 3.637883743784549}, {"source": 51, "target": 10, "value": 0.1744723293779277}, {"source": 51, "target": 13, "value": 4.8498027193921693}, {"source": 51, "target": 21, "value": 1.4707305982956105}, {"source": 51, "target": 22, "value": 3.7405576660750732}, {"source": 51, "target": 26, "value": 1.7970869941475833}, {"source": 51, "target": 30, "value": 0.60716957331649701}, {"source": 51, "target": 36, "value": 3.2546899980932062}, {"source": 51, "target": 43, "value": 0.74467929066985761}, {"source": 51, "target": 44, "value": 0.43849098669639275}, {"source": 51, "target": 61, "value": 1.7310823298179621}, {"source": 51, "target": 64, "value": 1.7550144657385294}, {"source": 51, "target": 71, "value": 1.8157899846604919}, {"source": 51, "target": 74, "value": 1.2470481247341407}, {"source": 51, "target": 75, "value": 0.38715402555114087}, {"source": 51, "target": 76, "value": 1.0783695381140155}, {"source": 51, "target": 79, "value": 1.7824192909632135}, {"source": 51, "target": 80, "value": 0.014961057248033562}, {"source": 51, "target": 81, "value": 1.3167197148598548}, {"source": 51, "target": 82, "value": 1.4707305982956105}, {"source": 51, "target": 88, "value": 3.0640098566965266}, {"source": 51, "target": 89, "value": 1.7169763693908857}, {"source": 51, "target": 90, "value": 2.7871569590917797}, {"source": 51, "target": 93, "value": 1.823867497718491}, {"source": 51, "target": 96, "value": 2.792657347785898}, {"source": 51, "target": 99, "value": 2.1454449447760902}, {"source": 52, "target": 67, "value": 1.7511116289004098}, {"source": 53, "target": 3, "value": 0.031462223330449422}, {"source": 54, "target": 63, "value": 1.6814624958738666}, {"source": 55, "target": 25, "value": 1.7480243102075688}, {"source": 56, "target": 13, "value": 0.92069172888216766}, {"source": 56, "target": 40, "value": 1.2035106114444378}, {"source": 56, "target": 49, "value": 1.645735034271179}, {"source": 57, "target": 90, "value": 1.7086464340498242}, {"source": 58, "target": 3, "value": 1.0306995027648562}, {"source": 58, "target": 6, "value": 0.44582483828855662}, {"source": 58, "target": 9, "value": 0.85835399034863857}, {"source": 58, "target": 13, "value": 1.7585842732886339}, {"source": 58, "target": 22, "value": 1.188377311996704}, {"source": 58, "target": 36, "value": 0.46049254147292629}, {"source": 58, "target": 96, "value": 0.071798407087424035}, {"source": 59, "target": 25, "value": 1.8223529640201162}, {"source": 60, "target": 63, "value": 1.8234791557445487}, {"source": 61, "target": 5, "value": 1.9107616938263643}, {"source": 61, "target": 23, "value": 1.0802030010120618}, {"source": 61, "target": 25, "value": 2.0519383369758173}, {"source": 61, "target": 51, "value": 1.7310823298179621}, {"source": 61, "target": 63, "value": 1.925429397010713}, {"source": 61, "target": 67, "value": 1.6027399269548324}, {"source": 61, "target": 94, "value": 0.81068395499947921}, {"source": 62, "target": 67, "value": 1.8363332750820374}, {"source": 63, "target": 3, "value": 3.7148891855024475}, {"source": 63, "target": 6, "value": 4.0650805990290007}, {"source": 63, "target": 7, "value": 0.044296463616751894}, {"source": 63, "target": 8, "value": 1.7589173025766489}, {"source": 63, "target": 9, "value": 3.8982354753069215}, {"source": 63, "target": 10, "value": 0.65850653446176977}, {"source": 63, "target": 11, "value": 1.6612687132288693}, {"source": 63, "target": 13, "value": 5.5391847690570186}, {"source": 63, "target": 19, "value": 1.7069959806605697}, {"source": 63, "target": 21, "value": 2.4204643794828113}, {"source": 63, "target": 22, "value": 3.769893072443792}, {"source": 63, "target": 26, "value": 2.4864690438124328}, {"source": 63, "target": 30, "value": 1.2305469586517459}, {"source": 63, "target": 36, "value": 2.9686697859982076}, {"source": 63, "target": 38, "value": 1.7638686627444127}, {"source": 63, "target": 43, "value": 1.496399078868236}, {"source": 63, "target": 44, "value": 0.90052363700368043}, {"source": 63, "target": 54, "value": 1.6814624958738666}, {"source": 63, "target": 60, "value": 1.8234791557445487}, {"source": 63, "target": 61, "value": 1.925429397010713}, {"source": 63, "target": 65, "value": 1.7144133123628666}, {"source": 63, "target": 66, "value": 1.7016368614201665}, {"source": 63, "target": 68, "value": 1.7950525232519756}, {"source": 63, "target": 72, "value": 0.18363964386815873}, {"source": 63, "target": 73, "value": 1.8256732878973223}, {"source": 63, "target": 74, "value": 1.1077049444827338}, {"source": 63, "target": 76, "value": 1.4487290435190767}, {"source": 63, "target": 77, "value": 1.7623152948486438}, {"source": 63, "target": 79, "value": 2.1381110931839049}, {"source": 63, "target": 80, "value": 0.37065285946872506}, {"source": 63, "target": 81, "value": 1.5917391495665552}, {"source": 63, "target": 82, "value": 2.046437948281679}, {"source": 63, "target": 84, "value": 1.8093046736956564}, {"source": 63, "target": 85, "value": 1.8186831323663619}, {"source": 63, "target": 86, "value": 1.7243354497970915}, {"source": 63, "target": 88, "value": 3.3206946624228069}, {"source": 63, "target": 90, "value": 2.5414729307537769}, {"source": 63, "target": 96, "value": 3.2180207401323031}, {"source": 63, "target": 98, "value": 1.7882759558066836}, {"source": 63, "target": 99, "value": 2.1161095384073718}, {"source": 64, "target": 51, "value": 1.7550144657385294}, {"source": 65, "target": 63, "value": 1.7144133123628666}, {"source": 66, "target": 63, "value": 1.7016368614201665}, {"source": 67, "target": 2, "value": 1.789751655307664}, {"source": 67, "target": 3, "value": 3.9569062880443582}, {"source": 67, "target": 6, "value": 3.6103818003138768}, {"source": 67, "target": 9, "value": 3.4692051571644447}, {"source": 67, "target": 13, "value": 5.2348299279815791}, {"source": 67, "target": 21, "value": 1.9914340613403345}, {"source": 67, "target": 22, "value": 4.1769218358097353}, {"source": 67, "target": 26, "value": 2.3727943441336521}, {"source": 67, "target": 30, "value": 1.538568725523257}, {"source": 67, "target": 31, "value": 1.8281004252344615}, {"source": 67, "target": 33, "value": 1.7840624453894098}, {"source": 67, "target": 36, "value": 2.5909764290009827}, {"source": 67, "target": 43, "value": 1.3680566760051067}, {"source": 67, "target": 44, "value": 1.2708831424087206}, {"source": 67, "target": 52, "value": 1.7511116289004098}, {"source": 67, "target": 61, "value": 1.6027399269548324}, {"source": 67, "target": 62, "value": 1.8363332750820374}, {"source": 67, "target": 72, "value": 0.27164586297431376}, {"source": 67, "target": 74, "value": 1.1553749798318933}, {"source": 67, "target": 75, "value": 0.18547310676620496}, {"source": 67, "target": 76, "value": 1.21404579256933}, {"source": 67, "target": 78, "value": 1.8370128735364362}, {"source": 67, "target": 79, "value": 1.9364301743989905}, {"source": 67, "target": 80, "value": 0.33031667571175044}, {"source": 67, "target": 81, "value": 1.3387212696363882}, {"source": 67, "target": 82, "value": 1.8777593616615533}, {"source": 67, "target": 88, "value": 3.1190137436378707}, {"source": 67, "target": 90, "value": 2.5561406339381261}, {"source": 67, "target": 91, "value": 1.8293625366497741}, {"source": 67, "target": 96, "value": 2.3709608812356056}, {"source": 67, "target": 99, "value": 1.9877671355442419}, {"source": 68, "target": 46, "value": 1.4627677132482866}, {"source": 68, "target": 48, "value": 1.5594066134638163}, {"source": 68, "target": 63, "value": 1.7950525232519756}, {"source": 69, "target": 95, "value": 1.6920642317624901}, {"source": 70, "target": 76, "value": 1.6152501893167122}, {"source": 71, "target": 51, "value": 1.8157899846604919}, {"source": 72, "target": 5, "value": 0.28264664036257003}, {"source": 72, "target": 25, "value": 0.5448318347829888}, {"source": 72, "target": 63, "value": 0.18363964386815873}, {"source": 72, "target": 67, "value": 0.27164586297431376}, {"source": 73, "target": 63, "value": 1.8256732878973223}, {"source": 74, "target": 5, "value": 0.96102791263914233}, {"source": 74, "target": 23, "value": 0.83818589847015124}, {"source": 74, "target": 25, "value": 1.0361998914589949}, {"source": 74, "target": 51, "value": 1.2470481247341407}, {"source": 74, "target": 63, "value": 1.1077049444827338}, {"source": 74, "target": 67, "value": 1.1553749798318933}, {"source": 75, "target": 25, "value": 0.19097349546034359}, {"source": 75, "target": 51, "value": 0.38715402555114087}, {"source": 75, "target": 67, "value": 0.18547310676620496}, {"source": 76, "target": 1, "value": 0.15797116329553285}, {"source": 76, "target": 5, "value": 0.97936254161960434}, {"source": 76, "target": 23, "value": 0.50449565102599325}, {"source": 76, "target": 24, "value": 1.7155977553833908}, {"source": 76, "target": 25, "value": 1.626574944629412}, {"source": 76, "target": 50, "value": 1.6663171588901187}, {"source": 76, "target": 51, "value": 1.0783695381140155}, {"source": 76, "target": 63, "value": 1.4487290435190767}, {"source": 76, "target": 67, "value": 1.21404579256933}, {"source": 76, "target": 70, "value": 1.6152501893167122}, {"source": 77, "target": 63, "value": 1.7623152948486438}, {"source": 78, "target": 67, "value": 1.8370128735364362}, {"source": 79, "target": 5, "value": 1.5477360400134879}, {"source": 79, "target": 23, "value": 0.84185282426624364}, {"source": 79, "target": 25, "value": 1.0508675946433435}, {"source": 79, "target": 51, "value": 1.7824192909632135}, {"source": 79, "target": 63, "value": 2.1381110931839049}, {"source": 79, "target": 67, "value": 1.9364301743989905}, {"source": 79, "target": 94, "value": 0.50266218812794705}, {"source": 80, "target": 5, "value": 0.058964166801121549}, {"source": 80, "target": 23, "value": 0.060797629699146788}, {"source": 80, "target": 25, "value": 0.20014080995055364}, {"source": 80, "target": 51, "value": 0.014961057248033562}, {"source": 80, "target": 63, "value": 0.37065285946872506}, {"source": 80, "target": 67, "value": 0.33031667571175044}, {"source": 81, "target": 5, "value": 1.30938586326767}, {"source": 81, "target": 23, "value": 0.79784971471317667}, {"source": 81, "target": 25, "value": 1.0251991140707175}, {"source": 81, "target": 51, "value": 1.3167197148598548}, {"source": 81, "target": 63, "value": 1.5917391495665552}, {"source": 81, "target": 67, "value": 1.3387212696363882}, {"source": 81, "target": 94, "value": 0.073631869985470236}, {"source": 82, "target": 5, "value": 1.6760784428766176}, {"source": 82, "target": 23, "value": 1.3038854745735313}, {"source": 82, "target": 25, "value": 1.6632442025903151}, {"source": 82, "target": 28, "value": 0.11946844243658347}, {"source": 82, "target": 51, "value": 1.4707305982956105}, {"source": 82, "target": 63, "value": 2.046437948281679}, {"source": 82, "target": 67, "value": 1.8777593616615533}, {"source": 82, "target": 94, "value": 0.058964166801121549}, {"source": 83, "target": 90, "value": 1.7139084677967418}, {"source": 84, "target": 63, "value": 1.8093046736956564}, {"source": 85, "target": 63, "value": 1.8186831323663619}, {"source": 86, "target": 63, "value": 1.7243354497970915}, {"source": 87, "target": 25, "value": 1.6789382730432418}, {"source": 88, "target": 1, "value": 0.96286137553720941}, {"source": 88, "target": 5, "value": 2.9906713407747416}, {"source": 88, "target": 23, "value": 2.5194713759772225}, {"source": 88, "target": 25, "value": 2.9558355457118841}, {"source": 88, "target": 28, "value": 2.0354371708934016}, {"source": 88, "target": 37, "value": 0.46782639306511109}, {"source": 88, "target": 51, "value": 3.0640098566965266}, {"source": 88, "target": 63, "value": 3.3206946624228069}, {"source": 88, "target": 67, "value": 3.1190137436378707}, {"source": 88, "target": 92, "value": 1.1498745911377757}, {"source": 88, "target": 94, "value": 1.1242061105651497}, {"source": 89, "target": 51, "value": 1.7169763693908857}, {"source": 90, "target": 1, "value": 0.33765052730391432}, {"source": 90, "target": 5, "value": 1.9547648033794314}, {"source": 90, "target": 23, "value": 1.600906464056786}, {"source": 90, "target": 25, "value": 2.4186309165847653}, {"source": 90, "target": 28, "value": 0.73184505038355507}, {"source": 90, "target": 36, "value": 0.20747466154273847}, {"source": 90, "target": 37, "value": 0.080965721577655053}, {"source": 90, "target": 51, "value": 2.7871569590917797}, {"source": 90, "target": 57, "value": 1.7086464340498242}, {"source": 90, "target": 63, "value": 2.5414729307537769}, {"source": 90, "target": 67, "value": 2.5561406339381261}, {"source": 90, "target": 83, "value": 1.7139084677967418}, {"source": 90, "target": 92, "value": 0.058964166801121549}, {"source": 90, "target": 94, "value": 1.1480411282397294}, {"source": 91, "target": 67, "value": 1.8293625366497741}, {"source": 92, "target": 3, "value": 1.6834122944688024}, {"source": 92, "target": 6, "value": 1.329553955146157}, {"source": 92, "target": 9, "value": 1.3607228244129215}, {"source": 92, "target": 13, "value": 2.4039632134004165}, {"source": 92, "target": 22, "value": 2.0904410578347457}, {"source": 92, "target": 36, "value": 0.90052363700368043}, {"source": 92, "target": 88, "value": 1.1498745911377757}, {"source": 92, "target": 90, "value": 0.058964166801121549}, {"source": 92, "target": 96, "value": 0.32848321281370418}, {"source": 93, "target": 51, "value": 1.823867497718491}, {"source": 94, "target": 3, "value": 2.2187834606978756}, {"source": 94, "target": 6, "value": 2.3269577716825389}, {"source": 94, "target": 9, "value": 2.5231383017733151}, {"source": 94, "target": 13, "value": 3.5847133197412506}, {"source": 94, "target": 22, "value": 3.3078604221364833}, {"source": 94, "target": 26, "value": 0.27164586297431376}, {"source": 94, "target": 36, "value": 1.7695850506769113}, {"source": 94, "target": 61, "value": 0.81068395499947921}, {"source": 94, "target": 79, "value": 0.50266218812794705}, {"source": 94, "target": 81, "value": 0.073631869985470236}, {"source": 94, "target": 82, "value": 0.058964166801121549}, {"source": 94, "target": 88, "value": 1.1242061105651497}, {"source": 94, "target": 90, "value": 1.1480411282397294}, {"source": 94, "target": 96, "value": 1.5605702802998114}, {"source": 94, "target": 99, "value": 0.15797116329553285}, {"source": 95, "target": 22, "value": 0.16530501488771765}, {"source": 95, "target": 69, "value": 1.6920642317624901}, {"source": 96, "target": 1, "value": 0.0021268169617310838}, {"source": 96, "target": 5, "value": 2.3159569942942615}, {"source": 96, "target": 23, "value": 1.9107616938263643}, {"source": 96, "target": 25, "value": 1.8337562521084654}, {"source": 96, "target": 28, "value": 0.45865907857488009}, {"source": 96, "target": 37, "value": 0.15247077460139422}, {"source": 96, "target": 51, "value": 2.792657347785898}, {"source": 96, "target": 58, "value": 0.071798407087424035}, {"source": 96, "target": 63, "value": 3.2180207401323031}, {"source": 96, "target": 67, "value": 2.3709608812356056}, {"source": 96, "target": 92, "value": 0.32848321281370418}, {"source": 96, "target": 94, "value": 1.5605702802998114}, {"source": 97, "target": 25, "value": 1.8270713190035144}, {"source": 98, "target": 63, "value": 1.7882759558066836}, {"source": 99, "target": 1, "value": 0.15063731170334801}, {"source": 99, "target": 5, "value": 1.687079220264895}, {"source": 99, "target": 23, "value": 1.3735570646992243}, {"source": 99, "target": 25, "value": 2.4222978423808574}, {"source": 99, "target": 28, "value": 0.72451119879137038}, {"source": 99, "target": 51, "value": 2.1454449447760902}, {"source": 99, "target": 63, "value": 2.1161095384073718}, {"source": 99, "target": 67, "value": 1.9877671355442419}, {"source": 99, "target": 94, "value": 0.15797116329553285}];


var nodes = {};

var list = ThresholdList(0); //初步设置为0

links.forEach(function(link, i) {
  link.id = i;
  link.source = nodes[link.source] || (nodes[link.source] = findNodeInfo(link.source));
  link.target = nodes[link.target] || (nodes[link.target] = findNodeInfo(link.target));
});

node_info.forEach(function(node, i){
  if (!(nodes[node.id])){
    nodes[node.id] = findNodeInfo(node.id);
  }
});

console.log(nodes);
var edges = links;

var fromToHtml = "";
node_info.forEach(function(variable, i){
  fromToHtml += "<option value='" + variable.id + "'>" + variable.id + "</option>";
});
$("#fromOptions").html(fromToHtml);
$("#toOptions").html(fromToHtml);

//记录当前被点中的点的信息
var clickedNode = nodes[1];

var width = 1560,
    height = 800;

var force = d3.layout.force()//layout将json格式转化为力学图可用的格式
    .nodes(d3.values(nodes))//设定节点数组
    .links(links)//设定连线数组
    .size([width, height])//作用域的大小
    .linkDistance(200)//连接线长度
    .charge(-200)//顶点的电荷数。该参数决定是排斥还是吸引，数值越小越互相排斥
    .on("tick", tick)//指时间间隔，隔一段时间刷新一次画面
    .start();//开始转换

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);


//箭头
/*var marker=
    svg.append("marker")
    //.attr("id", function(d) { return d; })
    .attr("id", "resolved")
    //.attr("markerUnits","strokeWidth")//设置为strokeWidth箭头会随着线的粗细发生变化
    .attr("markerUnits","userSpaceOnUse")
    .attr("viewBox", "0 -5 10 10")//坐标系的区域
    .attr("refX",32)//箭头坐标
    .attr("refY", -1)
    .attr("markerWidth", 12)//标识的大小
    .attr("markerHeight", 12)
    .attr("orient", "auto")//绘制方向，可设定为：auto（自动确认方向）和 角度值
    .attr("stroke-width",2)//箭头宽度
    .append("path")
    .attr("d", "M0,-5L10,0L0,5")//箭头的路径
    .attr('fill','#000000');//箭头颜色*/

// 将连接线设置为曲线
/*var path = svg.append("g").selectAll("path")
    .data(force.links())
    .enter().append("path")
    .attr("class", function(d) { return "link " + d.type; })
    .style("stroke",function(d){
        //console.log(d);
       return "#A254A2";//连接线的颜色
    })
    .attr("marker-end", function(d) { return "url(#" + d.type + ")"; });*/

//设置连接线    
var edges_line = svg.selectAll(".edgepath")
    .data(force.links())
    .enter()
    .append("path")
    .attr({
          'd': function(d) {return 'M '+d.source.x+' '+d.source.y+' L '+ d.target.x +' '+d.target.y},
          'class':'edgepath',
          //'fill-opacity':0,
          //'stroke-opacity':0,
          //'fill':'blue',
          //'stroke':'red',
          'id':function(d,i) {return 'edgepath'+i;}})
    .style("stroke", "#A254A2")
    .style("pointer-events", "none")
    .style("stroke-width",0.5)//线条粗细
    //.attr("marker-end", "url(#resolved)" );//根据箭头标记的id号标记箭头



var edges_text = svg.append("g").selectAll(".edgelabel")
.data(force.links())
.enter()
.append("text")
.style("pointer-events", "none")
//.attr("class","linetext")
.attr({  'class':'edgelabel',
               'id':function(d,i){return 'edgepath'+i;},
               'dx':80,
               'dy':0
               //'font-size':10,
               //'fill':'#aaa'
               });

//设置线条上的文字
/*edges_text.append('textPath')
.attr('xlink:href',function(d,i) {return '#edgepath'+i})
.style("pointer-events", "none")
.text(function(d){return d.value;});*/

//圆圈
var circle = svg.append("g").selectAll("circle")
    .data(force.nodes())//表示使用force.nodes数据
    .enter().append("circle")
    .attr("id", function(d, i){
      return "node" + i;
    })
    .style("fill","#B43232")
    /*function(node){
        var color;//圆圈背景色
        var link=links[node.index];
        if(node.name==link.source.name && link.rela=="主营产品"){
            color="#F6E8E9";
        }else{
            color="#F9EBF9";
        }
        return color;
    })*/
    .style('stroke',"#B43232")
    /*function(node){ 
        var color;//圆圈线条的颜色
        var link=links[node.index];
        if(node.name==link.source.name && link.rela=="主营产品"){
            color="#B43232";
        }else{
            color="#A254A2";
        }
        return color;
    })*/
    .attr("r", 5)//设置圆圈半径
    .on("click",function(node){
        //记录当前被点中的点的信息
        clickedNode = node;
        //单击时让连接线加粗
        edges_line.style("stroke-width",function(line){
            //console.log(line);
            if(line.source.name==node.name || line.target.name==node.name){
                return 4;
            }else{
                return 0.5;
            }
        });

        var html = "";
        html = getClickedNodeInfo(node);
        $('#node_info').html(html);
        //d3.select(this).style('stroke-width',2);
    })
    .call(force.drag);//将当前选中的元素传到drag函数中，使顶点可以被拖动
    /*
     circle.append("text")  
    .attr("dy", ".35em")  
    .attr("text-anchor", "middle")//在圆圈内添加文字  
    .text(function(d) { 
        //console.log(d);
        return d.name; 
    }); */ 

  //圆圈的提示文字
  circle.append("svg:title")  
        .text(function(node) { 
            var link=links[node.index];
            if(node.name==link.source.name){
                return "双击可查看详情"
            }
         });  
/* 矩形
var rect=svg.append("rect")
         .attr({"x":100,"y":100,
                "width":100,"height":50,
                "rx":5,//水平圆角
                "ry":10//竖直圆角
             })
          .style({
             "stroke":"red",
             "stroke-width":1,
             "fill":"yellow"
});*/
var text = svg.append("g").selectAll("text")
    .data(force.nodes())
    //返回缺失元素的占位对象（placeholder），指向绑定的数据中比选定元素集多出的一部分元素。
    .enter()
    .append("text")
    .attr("dx", 8)
    .attr("dy", ".35em")  
    //.attr("text-anchor", "middle")//在圆圈中加上数据  
    .style('fill',"#B43232")
    .text(function(d) { 
        return d.name; 
    });

/*  将文字显示在圆圈的外面 
var text2 = svg.append("g").selectAll("text")
     .data(force.links())
    //返回缺失元素的占位对象（placeholder），指向绑定的数据中比选定元素集多出的一部分元素。
    .enter()
    .append("text")
    .attr("x", 150)//设置文字坐标
    .attr("y", ".50em")
    .text(function(d) { 
        //console.log(d);
        //return d.name; 
        //return d.rela;
        console.log(d);
        return  '1111';
    });*/


function tick() {
  //path.attr("d", linkArc);//连接线
  circle.attr("transform", transform1);//圆圈
  text.attr("transform", transform2);//顶点文字
  //edges_text.attr("transform", transform3);
  //text2.attr("d", linkArc);//连接线文字
  //console.log("text2...................");
  //console.log(text2);
  //edges_line.attr("x1",function(d){ return d.source.x; });
  //edges_line.attr("y1",function(d){ return d.source.y; });
  //edges_line.attr("x2",function(d){ return d.target.x; });
  //edges_line.attr("y2",function(d){ return d.target.y; });
    
  //edges_line.attr("x",function(d){ return (d.source.x + d.target.x) / 2 ; });
  //edges_line.attr("y",function(d){ return (d.source.y + d.target.y) / 2 ; });


  edges_line.attr('d', function(d) { 
      var path='M '+d.source.x+' '+d.source.y+' L '+ d.target.x +' '+d.target.y;
      return path;
  });  
    
  edges_text.attr('transform',function(d,i){
        if (d.target.x<d.source.x){
            bbox = this.getBBox();
            rx = bbox.x+bbox.width/2;
            ry = bbox.y+bbox.height/2;
            return 'rotate(180 '+rx+' '+ry+')';
        }
        else {
            return 'rotate(0)';
        }
   });
}

//设置连接线的坐标,使用椭圆弧路径段双向编码
function linkArc(d) {
    //var dx = d.target.x - d.source.x,
  // dy = d.target.y - d.source.y,
     // dr = Math.sqrt(dx * dx + dy * dy);
  //return "M" + d.source.x + "," + d.source.y + "A" + dr + "," + dr + " 0 0,1 " + d.target.x + "," + d.target.y;
  //打点path格式是：Msource.x,source.yArr00,1target.x,target.y  
  
  return 'M '+d.source.x+' '+d.source.y+' L '+ d.target.x +' '+d.target.y
}
//设置圆圈和文字的坐标
function transform1(d) {
  return "translate(" + d.x + "," + d.y + ")";
}
function transform2(d) {
      return "translate(" + (d.x) + "," + d.y + ")";
}

function findNodeInfo(node){
  var result = {};
  node_info.forEach(function(d){
    if (node == d.id){
      result = {name: node, group: d.group};
    }
  });
  return result;
}

function getClickedNodeInfo(node){
  var result = "";
  result += "<p>node id:" + node.name + "</p>";
  result += "<p>node group" + node.group + "</p>";
  return result;
}

function changeScale(){
  var scale = $( "#slider" ).slider( "value" );
  console.log(scale);
  circle
    .transition()
    .duration(500)
    .attr("r", 2 + (scale - 30) * 0.06);
  force
  .charge(-(30 + (scale - 30)))
  .linkDistance(2 + (scale - 30) * 0.06)
  .start();
 // update();
}

function draw(){
  var selection = $("#calculator").val();
  switch(selection)
  {
    case "MinimumSpanningTree":
      //最小生成树数据，下面是接口例子,函数需要返回的是边的id的列表，如[1, 2, 4, 50, ...]
      //var spanningTreeLinks = [23, 29, 46, 52, 349, 527];
      var spanningTreeLinks;
      console.log(list);
      spanningTreeLinks = MST(list, clickedNode);
      //console.log(list);

      //显示最小生成树
      var resNodes = [];
      spanningTreeLinks.forEach(function(variable){
        if (resNodes.indexOf(edges[variable].source) < 0){
          resNodes.push(edges[variable].source); 
        }
        if (resNodes.indexOf(edges[variable].target) < 0){
          resNodes.push(edges[variable].target); 
        }
      });
      //console.log(resNodes.length);

      //给边填色加粗
      edges_line
        .style("stroke", function(line){
          var notChanged = true;
          var color = "#A254A2";
          spanningTreeLinks.forEach(function(variable){
            if (notChanged){
              if (line.id == variable)
              {
                color = "#FF8000";
              }
            }
          });
          return color;
        })
        .style("stroke-width", function(line){
          var notChanged = true;
          var width = 0.5;
          spanningTreeLinks.forEach(function(variable){
            if (notChanged){
              if (line.id == variable)
              {
                width = 4;
              }
            }
          });
          return width;
        });

      //给圆圈填色加粗
      circle
        .style("fill", function(d){
          var notChanged = true;
          var color = "#B43232";
          resNodes.forEach(function(variable){
            if (notChanged){
              if (d.name == variable.name)
              {
                color = "#FF8000";
              }
            }
          });
          return color;
        })
        .style("stoke", function(d){
          var notChanged = true;
          var color = "#B43232";
          resNodes.forEach(function(variable){
            if (notChanged){
              if (d.name == variable.name)
              {
                color = "#FF8000";
              }
            }
          });
          return color;
        });
      break;

    case "PointCloseness":
      //PointCloseness数据，下面是接口例子，函数需要返回的是对应每个node的中心度的按比例尺缩放归一化列表，如[0.01，0.2，0.05，0.6，1，...
      //var pointCloseness = [0.01, 0.2, 0.05, 0.6, 1];
      var pointCloseness;
      pointCloseness = pointCloseness1(list, node_info, edges);
      console.log(pointCloseness);
      //再看看，总觉得算法接口不太对

      //显示结束中心度
      var a = d3.rgb(255,0,0);    //红色  
      var b = d3.rgb(0,255,0);    //绿色  

      var compute = d3.interpolate(a,b);  

      edges_line
        .style("stroke", "#A254A2")
        .style("stroke-width", 0.5)

      circle
        .transition()
        .style("fill", function(d){
          console.log(compute(pointCloseness[d.name]));
          return compute(pointCloseness[d.name]); 
        })
        .style('stroke', function(d){
          return compute(pointCloseness[d.name]); 
        });
      break;

    case "PointBetweeness":
      //PointBetweeness数据，下面是接口例子，函数需要返回的是对应每个node的中心度的按比例尺缩放归一化列表，如[0.01，0.2，0.05，0.6，1，...]
      //var pointBetweeness = [0.4, 0.07, 0.33, 0.25, 0.87];
      var pointBetweeness;
      pointBetweeness = pointBetweeness1(list, node_info);
      console.log(pointBetweeness);

      //显示紧密中心度
      var a = d3.rgb(255,0,0);    //红色  
      var b = d3.rgb(0,255,0);    //绿色  

      var compute = d3.interpolate(a,b);  

      edges_line
        .style("stroke", "#A254A2")
        .style("stroke-width", 0.5)

      circle
        .transition()
        .style("fill", function(d){
          console.log(compute(pointBetweeness[d.name]));
          return compute(pointBetweeness[d.name]); 
        })
        .style('stroke', function(d){
          return compute(pointBetweeness[d.name]); 
        });
      break;

    /*case "StrongConnectedComponent":
      //强连通分量数据，下面是接口例子
      var strongConnectedComponent;
      /*strongConnectedComponent = strongConnectedComponent(links, node_info);
      console.log(strongConnectedComponent);
      break;*/

    case "ConnectedComponent":
      //对于无向图，强连通分量=连通分量，所以只考虑一个，下面是接口例子，函数需要返回的是边的id的列表，如[1, 2, 4, 50, ...]，其实最小生成树就是一个强连通分量
      //var connectedComponent = [230, 290, 460, 452, 349, 527];
      var connectedComponent;
      connectedComponent = connectedComponent1(list, clickedNode);
      console.log(connectedComponent);

      //显示连通分量
      var resNodes = [];
      connectedComponent.forEach(function(variable){
        if (resNodes.indexOf(links[variable].source) < 0){
          resNodes.push(links[variable].source); 
        }
        if (resNodes.indexOf(links[variable].target) < 0){
          resNodes.push(links[variable].target); 
        }
      });
      //console.log(resNodes);

      //给边填色加粗
      edges_line
        .style("stroke", function(line){
          var notChanged = true;
          var color = "#A254A2";
          connectedComponent.forEach(function(variable){
            if (notChanged){
              if (line.id == variable)
              {
                color = "#FF8000";
              }
            }
          });
          return color;
        })
        .style("stroke-width", function(line){
          var notChanged = true;
          var width = 0.5;
          connectedComponent.forEach(function(variable){
            if (notChanged){
              if (line.id == variable)
              {
                width = 4;
              }
            }
          });
          return width;
        });

      //给圆圈填色加粗
      circle
        .style("fill", function(d){
          var notChanged = true;
          var color = "#B43232";
          resNodes.forEach(function(variable){
            if (notChanged){
              if (d.name == variable.name)
              {
                color = "#FF8000";
              }
            }
          });
          return color;
        })
        .style("stoke", function(d){
          var notChanged = true;
          var color = "#B43232";
          resNodes.forEach(function(variable){
            if (notChanged){
              if (d.name == variable.name)
              {
                color = "#FF8000";
              }
            }
          });
          return color;
        });
      break;
  }
}

function drawShortestPath(){
  //最短路径数据，下面是接口例子,函数需要返回的是边的id的列表，如[1, 2, 4, 50, ...]
  //= [1, 2, 4, 50, 300, 301];
  var start = $("#fromOptions").val();
  var end = $("#toOptions").val();

  var shortestPath = shortestPath111(list, start, end);
  console.log(shortestPath);

  //显示最短路径
  //
  var resNodes = [];
  shortestPath.forEach(function(variable){
    if (resNodes.indexOf(links[variable].source) < 0){
      resNodes.push(links[variable].source); 
    }
    if (resNodes.indexOf(links[variable].target) < 0){
      resNodes.push(links[variable].target); 
    }
  });
  console.log(resNodes);

  //给边填色加粗
  edges_line
    .style("stroke", function(line){
      var notChanged = true;
      var color = "#A254A2";
      shortestPath.forEach(function(variable){
        if (notChanged){
          if (line.id == variable)
          {
            color = "#FF8000";
          }
        }
      });
      return color;
    })
    .style("stroke-width", function(line){
      var notChanged = true;
      var width = 0.5;
      shortestPath.forEach(function(variable){
        if (notChanged){
          if (line.id == variable)
          {
            width = 4;
          }
        }
      });
      return width;
    });

  //给圆圈填色加粗
  circle
    .style("fill", function(d){
      var notChanged = true;
      var color = "#B43232";
      resNodes.forEach(function(variable){
        if (notChanged){
          if (d.name == variable.name)
          {
            color = "#FF8000";
          }
        }
      });
      return color;
    })
    .style("stoke", function(d){
      var notChanged = true;
      var color = "#B43232";
      resNodes.forEach(function(variable){
        if (notChanged){
          if (d.name == variable.name)
          {
            color = "#FF8000";
          }
        }
      });
      return color;
    });
}

//此处的t用于设置可以显示的边的最小权值,list其实相当于一个邻接链表
function ThresholdList(t)
{
  var list = {};
  var numOfVertex = node_info.length;
  var numOfLinks = links.length;


  for (var i = 0; i < numOfVertex; ++i) {
    list[node_info[i].id] = [];
  }

  for (var i = 0; i < numOfLinks; ++i) {
    if (links[i].value > t) {
      list[links[i].source].push({"ID": links[i].source, "next": links[i].target, "value": links[i].value, "IDOfLink": i});
    }
  }
  return list;
}
</script>
<script type="text/javascript" src="static/js/Data.js"></script>
<script src="static/js/priority.js"></script>
<script src="static/js/algorithm.js"></script>
